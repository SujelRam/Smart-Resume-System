{% extends "base.html" %}
{% block content %}

<h4 class="mb-3 fw-bold">Admin Dashboard</h4>

<!-- ðŸ”¹ Job Criteria Section -->
<div class="card shadow-sm p-3 mb-4">
  <h6 class="fw-bold mb-2">Set Job Criteria</h6>

  <form method="POST">
    <input class="form-control mb-2" name="skills" placeholder="Add skills (python, sql)">
    <button class="btn btn-success">Update Criteria</button>
  </form>

  {% if job %}
  <div class="mt-3">
    <b>Current Skills:</b><br>
    {% for s in job.skills_required.split(",") %}
      <span class="badge bg-primary me-1 mt-1">
        {{s}}
        <a href="/delete-skill/{{s}}" 
           style="color:white; text-decoration:none; margin-left:5px;">
           Ã—
        </a>
      </span>
    {% endfor %}
  </div>
  {% endif %}
</div>

<!-- ðŸ”¹ Action Buttons -->
<div class="d-flex gap-2 mb-3">
  <a class="btn btn-outline-primary btn-sm" href="/admin">All</a>
  <a class="btn btn-outline-success btn-sm" href="/admin?filter=shortlisted">Shortlisted</a>

  <!-- ðŸ”¥ Delete All -->
  <a href="/delete-all" 
     class="btn btn-danger btn-sm ms-auto"
     onclick="return confirm('Are you sure to delete ALL resumes?')">
     Delete All
  </a>
</div>

<hr>

<!-- ðŸ”¹ Candidate Cards -->
{% for r in resumes %}
<div class="card shadow-sm p-3 mb-3">

  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center">
    <h6 class="fw-bold mb-0">Candidate #{{loop.index}}</h6>

    <span class="badge bg-{% if r.status=='Matched' %}success{% else %}danger{% endif %}">
      {{r.status}}
    </span>
  </div>

  <!-- Candidate Info -->
  <div class="mt-2">
    {% for u in users %}
      {% if u.id == r.user_id %}
        <p class="mb-1"><b>Name:</b> {{u.name}}</p>
        <p><b>Email:</b> 
            <a href="mailto:{{u.email}}" class="text-primary">
               {{u.email}}
            </a>
        </p>
      {% endif %}
    {% endfor %}
  </div>

  <!-- Buttons -->
  <div class="mt-3 d-flex gap-2">
    <a href="/view-resume/{{r.id}}" 
       target="_blank" 
       class="btn btn-dark btn-sm">
       View Resume
    </a>

    <a href="/delete-resume/{{r.id}}" 
       class="btn btn-danger btn-sm"
       onclick="return confirm('Delete this resume?')">
       Delete
    </a>
  </div>

</div>
{% endfor %}

{% endblock %}